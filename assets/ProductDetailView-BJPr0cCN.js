import{k as tt,l as At,m as et,p as yt,q as wt,s as Nt,d as St,v as Lt,r as D,c as q,x as Ot,o as xt,w as H,a as y,b as w,e as L,f as e,_ as Rt,y as Dt,i as W,u as B,R as Y,F as k,g as J,t as v,h as kt,j as P,z as Pt}from"./index-DeAbvZPb.js";import{S as Vt,A as $t}from"./autoplay-CcLt2_l8.js";import{c as Mt,a as Xt}from"./products-CdmBiZxz.js";var V={exports:{}},$={exports:{}};/*!
  * Bootstrap swipe.js v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var Ut=$.exports,Z;function qt(){return Z||(Z=1,(function(O,M){(function(u,o){O.exports=o(tt(),At(),et())})(Ut,(function(u,o,p){const r="swipe",c=".bs.swipe",T=`touchstart${c}`,g=`touchmove${c}`,N=`touchend${c}`,d=`pointerdown${c}`,m=`pointerup${c}`,C="touch",S="pen",_="pointer-event",n=40,a={endCallback:null,leftCallback:null,rightCallback:null},f={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class E extends o{constructor(s,I){super(),this._element=s,!(!s||!E.isSupported())&&(this._config=this._getConfig(I),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return a}static get DefaultType(){return f}static get NAME(){return r}dispose(){u.off(this._element,c)}_start(s){if(!this._supportPointerEvents){this._deltaX=s.touches[0].clientX;return}this._eventIsPointerPenTouch(s)&&(this._deltaX=s.clientX)}_end(s){this._eventIsPointerPenTouch(s)&&(this._deltaX=s.clientX-this._deltaX),this._handleSwipe(),p.execute(this._config.endCallback)}_move(s){this._deltaX=s.touches&&s.touches.length>1?0:s.touches[0].clientX-this._deltaX}_handleSwipe(){const s=Math.abs(this._deltaX);if(s<=n)return;const I=s/this._deltaX;this._deltaX=0,I&&p.execute(I>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(u.on(this._element,d,s=>this._start(s)),u.on(this._element,m,s=>this._end(s)),this._element.classList.add(_)):(u.on(this._element,T,s=>this._start(s)),u.on(this._element,g,s=>this._move(s)),u.on(this._element,N,s=>this._end(s)))}_eventIsPointerPenTouch(s){return this._supportPointerEvents&&(s.pointerType===S||s.pointerType===C)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}return E}))})($)),$.exports}/*!
  * Bootstrap carousel.js v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var Wt=V.exports,j;function Bt(){return j||(j=1,(function(O,M){(function(u,o){O.exports=o(yt(),tt(),wt(),Nt(),et(),qt())})(Wt,(function(u,o,p,r,c,T){const g="carousel",d=".bs.carousel",m=".data-api",C="ArrowLeft",S="ArrowRight",_=500,n="next",a="prev",f="left",E="right",st=`slide${d}`,s=`slid${d}`,I=`keydown${d}`,it=`mouseenter${d}`,nt=`mouseleave${d}`,ot=`dragstart${d}`,rt=`load${d}${m}`,at=`click${d}${m}`,K="carousel",x="active",lt="slide",ct="carousel-item-end",ut="carousel-item-start",dt="carousel-item-next",_t="carousel-item-prev",F=".active",G=".carousel-item",ht=F+G,pt=".carousel-item img",mt=".carousel-indicators",ft="[data-bs-slide], [data-bs-slide-to]",Et='[data-bs-ride="carousel"]',vt={[C]:E,[S]:f},Tt={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},gt={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class A extends u{constructor(t,i){super(t,i),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=r.findOne(mt,this._element),this._addEventListeners(),this._config.ride===K&&this.cycle()}static get Default(){return Tt}static get DefaultType(){return gt}static get NAME(){return g}next(){this._slide(n)}nextWhenVisible(){!document.hidden&&c.isVisible(this._element)&&this.next()}prev(){this._slide(a)}pause(){this._isSliding&&c.triggerTransitionEnd(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){o.one(this._element,s,()=>this.cycle());return}this.cycle()}}to(t){const i=this._getItems();if(t>i.length-1||t<0)return;if(this._isSliding){o.one(this._element,s,()=>this.to(t));return}const l=this._getItemIndex(this._getActive());if(l===t)return;const b=t>l?n:a;this._slide(b,i[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&o.on(this._element,I,t=>this._keydown(t)),this._config.pause==="hover"&&(o.on(this._element,it,()=>this.pause()),o.on(this._element,nt,()=>this._maybeEnableCycle())),this._config.touch&&T.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const l of r.find(pt,this._element))o.on(l,ot,b=>b.preventDefault());const i={leftCallback:()=>this._slide(this._directionToOrder(f)),rightCallback:()=>this._slide(this._directionToOrder(E)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),_+this._config.interval))}};this._swipeHelper=new T(this._element,i)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const i=vt[t.key];i&&(t.preventDefault(),this._slide(this._directionToOrder(i)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const i=r.findOne(F,this._indicatorsElement);i.classList.remove(x),i.removeAttribute("aria-current");const l=r.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);l&&(l.classList.add(x),l.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const i=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=i||this._config.defaultInterval}_slide(t,i=null){if(this._isSliding)return;const l=this._getActive(),b=t===n,h=i||c.getNextActiveElement(this._getItems(),l,b,this._config.wrap);if(h===l)return;const z=this._getItemIndex(h),Q=It=>o.trigger(this._element,It,{relatedTarget:h,direction:this._orderToDirection(t),from:this._getItemIndex(l),to:z});if(Q(st).defaultPrevented||!l||!h)return;const bt=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(z),this._activeElement=h;const R=b?ut:ct,U=b?dt:_t;h.classList.add(U),c.reflow(h),l.classList.add(R),h.classList.add(R);const Ct=()=>{h.classList.remove(R,U),h.classList.add(x),l.classList.remove(x,U,R),this._isSliding=!1,Q(s)};this._queueCallback(Ct,l,this._isAnimated()),bt&&this.cycle()}_isAnimated(){return this._element.classList.contains(lt)}_getActive(){return r.findOne(ht,this._element)}_getItems(){return r.find(G,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return c.isRTL()?t===f?a:n:t===f?n:a}_orderToDirection(t){return c.isRTL()?t===a?f:E:t===a?E:f}static jQueryInterface(t){return this.each(function(){const i=A.getOrCreateInstance(this,t);if(typeof t=="number"){i.to(t);return}if(typeof t=="string"){if(i[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);i[t]()}})}}return o.on(document,at,ft,function(X){const t=r.getElementFromSelector(this);if(!t||!t.classList.contains(K))return;X.preventDefault();const i=A.getOrCreateInstance(t),l=this.getAttribute("data-bs-slide-to");if(l){i.to(l),i._maybeEnableCycle();return}if(p.getDataAttribute(this,"slide")==="next"){i.next(),i._maybeEnableCycle();return}i.prev(),i._maybeEnableCycle()}),o.on(window,rt,()=>{const X=r.find(Et);for(const t of X)A.getOrCreateInstance(t)}),c.defineJQueryPlugin(A),A}))})(V)),V.exports}Bt();const Yt={class:"container"},Kt={class:"row align-items-center"},Ft={class:"col-md-7"},Gt={"aria-label":"breadcrumb"},zt={class:"breadcrumb bg-white px-0 py-3"},Qt={class:"breadcrumb-item"},Ht={class:"breadcrumb-item"},Jt={id:"carouselExample",class:"carousel slide"},Zt={class:"carousel-inner"},jt={class:"carousel-item active"},te=["src"],ee=["src"],se={class:"col-md-5"},ie={class:"fw-bold h1"},ne={class:"text-end text-muted"},oe={class:"h4 fw-bold text-end"},re={class:"row"},ae={class:"col-6"},le={class:"input-group my-3 bg-light rounded"},ce=["disabled"],ue=["value"],de={class:"row my-5"},_e={class:"col-md-4"},he={class:"col-md-3 text-muted",style:{"white-space":"pre-wrap"}},pe={class:"swiper-wrapper"},me={class:"card border-0"},fe=["src"],Ee={class:"card-body p-0"},ve={class:"mt-3"},Te={class:"text-muted ms-2"},Ae=St({__name:"ProductDetailView",setup(O){const M=Ot(),u=Lt(),o=D(1),p=q(()=>M.params.id),r=D({category:"",content:"",description:"",id:"",imageUrl:"",imagesUrl:[],is_enabled:0,num:0,origin_price:0,price:0,title:"",unit:""}),c=D([]),T=q(()=>r.value.category),g=q(()=>c.value.filter(_=>_.id!==p.value)),N=async()=>{try{const _=await Mt(p.value);r.value=_.data.product,await d()}catch{alert("取得產品資訊失敗")}},d=async()=>{if(T.value)try{const _=await Xt({category:T.value});c.value=_.data.products}catch{alert("取得推薦商品失敗")}};xt(()=>{N()}),H(p,()=>{o.value=1,N()});const m=D(null);let C=null;H(g,async _=>{_.length&&(await Pt(),m.value&&(C?.destroy(!0,!0),C=new Vt(m.value,{modules:[$t],loop:!0,autoplay:{delay:2500,disableOnInteraction:!1},slidesPerView:2,spaceBetween:10,breakpoints:{767:{slidesPerView:3,spaceBetween:30}}})))});const S=()=>{u.addCartItem({product_id:p.value,qty:o.value})};return(_,n)=>(w(),y(k,null,[L(Rt),e("div",Yt,[e("div",Kt,[e("div",Ft,[e("nav",Gt,[e("ol",zt,[e("li",Qt,[L(B(Y),{class:"text-muted",to:"/"},{default:W(()=>[...n[2]||(n[2]=[P("首頁",-1)])]),_:1})]),e("li",Ht,[L(B(Y),{class:"text-muted",to:"/products"},{default:W(()=>[...n[3]||(n[3]=[P("產品列表",-1)])]),_:1})]),n[4]||(n[4]=e("li",{class:"breadcrumb-item active"},"產品詳細",-1))])]),e("div",Jt,[e("div",Zt,[e("div",jt,[e("img",{src:r.value.imageUrl,class:"d-block w-100",alt:"主圖"},null,8,te)]),(w(!0),y(k,null,J(r.value.imagesUrl.filter(Boolean),a=>(w(),y("div",{key:a,class:"carousel-item"},[e("img",{src:a,class:"d-block w-100",alt:"副圖"},null,8,ee)]))),128))]),n[5]||(n[5]=e("button",{class:"carousel-control-prev","data-bs-slide":"prev"},[e("span",{class:"carousel-control-prev-icon"})],-1)),n[6]||(n[6]=e("button",{class:"carousel-control-next","data-bs-slide":"next"},[e("span",{class:"carousel-control-next-icon"})],-1))])]),e("div",se,[e("h2",ie,v(r.value.title),1),e("p",ne,[e("del",null,"NT$ "+v(r.value.origin_price.toLocaleString("zh-TW")),1)]),e("p",oe,"NT$ "+v(r.value.price.toLocaleString("zh-TW")),1),e("div",re,[e("div",ae,[e("div",le,[e("button",{class:"btn btn-outline-dark",disabled:o.value<=1,onClick:n[0]||(n[0]=a=>o.value--)}," − ",8,ce),e("input",{class:"form-control text-center bg-light",readonly:"",value:o.value},null,8,ue),e("button",{class:"btn btn-outline-dark",onClick:n[1]||(n[1]=a=>o.value++)},"+")])]),e("div",{class:"col-6"},[e("button",{class:"btn btn-dark w-100 py-2",onClick:S},"加入購物車")])])])]),e("div",de,[e("div",_e,v(r.value.description),1),e("div",he,v(r.value.content),1)]),g.value.length?(w(),y(k,{key:0},[n[7]||(n[7]=e("h3",{class:"fw-bold"},"你可能會喜歡的植栽",-1)),e("div",{ref_key:"swiperContainer",ref:m,class:"swiper mt-4 mb-5"},[e("div",pe,[(w(!0),y(k,null,J(g.value,a=>(w(),y("div",{key:a.id,class:"swiper-slide"},[e("div",me,[e("img",{src:a.imageUrl,class:"card-img-top",style:{height:"280px"}},null,8,fe),e("div",Ee,[e("h4",ve,[L(B(Y),{to:`/products/${a.id}`},{default:W(()=>[P(v(a.title),1)]),_:2},1032,["to"])]),e("p",null,[P(" NT$ "+v(a.price.toLocaleString("zh-TW"))+" ",1),e("del",Te," NT$ "+v(a.origin_price.toLocaleString("zh-TW")),1)])])])]))),128))])],512)],64)):Dt("",!0)]),L(kt)],64))}});export{Ae as default};
